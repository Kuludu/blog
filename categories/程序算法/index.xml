<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ç¨‹åºç®—æ³• on Kuluduçš„åšå®¢</title><link>https://blog.kuludu.net/categories/%E7%A8%8B%E5%BA%8F%E7%AE%97%E6%B3%95/</link><description>Recent content in ç¨‹åºç®—æ³• on Kuluduçš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Kuludu</copyright><lastBuildDate>Fri, 25 Oct 2024 09:35:00 +0800</lastBuildDate><atom:link href="https://blog.kuludu.net/categories/%E7%A8%8B%E5%BA%8F%E7%AE%97%E6%B3%95/index.xml" rel="self" type="application/rss+xml"/><item><title>æœ‰é”æ ˆä¸æ— é”æ ˆï¼Œå®ç°ä¸æ€§èƒ½å¯¹æ¯”</title><link>https://blog.kuludu.net/article/lock-required-stack-vs-lock-free-stack/</link><pubDate>Fri, 25 Oct 2024 09:35:00 +0800</pubDate><guid>https://blog.kuludu.net/article/lock-required-stack-vs-lock-free-stack/</guid><description>&lt;p&gt;å¤šçº¿ç¨‹åŒæ­¥æ˜¯ç°ä»£ç¨‹åºè®¾è®¡ä¸­ä¸€ä¸ªé‡è¦é—®é¢˜ï¼Œæƒ³è¦æ·±å…¥ç†è§£è¿™ä¸€é—®é¢˜ï¼Œå°±ä¸å¾—ä¸æ·±å…¥åˆ°å¤„ç†å™¨ä¸æ“ä½œç³»ç»Ÿçš„å…·ä½“å®ç°ä¸­ã€‚ä½†æ˜¯æˆ‘æ°´å¹³æœ‰é™â”‘(ï¿£Ğ” ï¿£)â”ï¼Œæœ¬æ–‡ä¸è¿‡äºè¯¦ç»†åœ°å»æ¢è®¨è¿™ä¸€é—®é¢˜ï¼Œè€Œæ˜¯ä»¥æœ‰é”æ ˆä¸æ— é”æ ˆä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œä¸»è¦å¯¹ä»£ç å®ç°ä¸å®éªŒæ€§èƒ½ä¸Šå¯¹ä¸¤è€…è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;h2 id="æœ‰é”æ ˆä¸æ— é”æ ˆ"&gt;æœ‰é”æ ˆä¸æ— é”æ ˆ
&lt;/h2&gt;&lt;p&gt;æœ‰é”æ ˆçš„å®ç°æ–¹å¼å…¶å®æ¯”è¾ƒç®€å•ï¼Œåœ¨çº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºçš„æ—¶å€™åŠ é”å³å¯ï¼Œåœ¨å®Œæˆå¯¹æ ˆçš„æ“ä½œè§£é™¤å¯¹é”çš„å æœ‰ã€‚ä½†æ˜¯åŠ é”è§£é”çš„è¿‡ç¨‹å¯¹èµ„æºçš„æ¶ˆè€—æ¯”è¾ƒå¤§ï¼Œå½“çº¿ç¨‹æ²¡æœ‰Acquireåˆ°é”çš„æ—¶å€™ä¼šå‘ç”ŸçŠ¶æ€çš„åˆ‡æ¢ï¼Œè¿™åœ¨éœ€è¦é«˜æ€§èƒ½è®¡ç®—çš„åœºæ™¯ä¸‹æˆ–è®¸å¹¶ä¸åˆé€‚ã€‚&lt;/p&gt;
&lt;p&gt;Compare And Swap(CAS)æ˜¯ä¸€ç§å¸¸è§çš„åŸå­æ“ä½œï¼Œæ˜¯å®ç°æ— é”åŒæ­¥çš„ä¸€ä¸ªæ–¹å¼ï¼Œå…¶ä¸»è¦æ€æƒ³å°±æ˜¯Compareå’ŒSwapä¸¤ä¸ªè¿‡ç¨‹ã€‚Compareçš„ç›®çš„ä¸»è¦æ˜¯æ¢æµ‹å†…å­˜ä¸­çš„å€¼æ˜¯å¦ä¸ºæœŸå¾…å€¼ï¼Œå¦‚æœæ˜¯åˆ™Swapä¸ºè®¾å®šçš„å€¼ã€‚è¿™ä¸»è¦ä¾èµ–äºå¤„ç†å™¨çš„å®ç°ï¼Œæ¯”å¦‚x86å¤„ç†å™¨çš„&lt;code&gt;CMPXCHG&lt;/code&gt;ä¸ARMå¤„ç†å™¨çš„&lt;code&gt;LDREX/STREX&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="å®ç°ä¸å®éªŒ"&gt;å®ç°ä¸å®éªŒ
&lt;/h2&gt;&lt;h3 id="cå®ç°"&gt;C++å®ç°
&lt;/h3&gt;&lt;p&gt;æœ¬æ–‡ä¸»è¦å¯¹æ¯”C++æ ‡å‡†åº“å®ç°çš„æ ˆï¼Œä¼šç”¨åˆ°ä¸€äº›æ¯”è¾ƒæ–°çš„C++æ ‡å‡†ï¼Œå®éªŒç¯å¢ƒä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è…¾è®¯äº‘Cloud Studio 1C2Gï¼ˆè‡´è°¢ï¼ï¼‰&lt;/li&gt;
&lt;li&gt;gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.2)&lt;/li&gt;
&lt;li&gt;g++ experiment.cpp -o experiment -pthread&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†å‡å°‘ä»£ç å†—ä½™ï¼Œä¸¤ä¸ªæ ˆå®ç°çš„å†…éƒ¨æ•°æ®ç»“æ„å‡ä¸ºä»¥ä¸‹ä»£ç æ®µã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;nullptr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹ä¸ºæœ‰é”æ ˆçš„å®ç°ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;unique_lock&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;mutex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mtx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;new_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;new_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_node&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="nf"&gt;top&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;unique_lock&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;mutex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mtx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;runtime_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Stack is empty.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;unique_lock&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;mutex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mtx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;next_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;next_node&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;runtime_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Stack is empty.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;is_empty&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;noexcept&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;unique_lock&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;mutex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mtx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="k"&gt;nullptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æœ‰é”æ ˆçš„å®ç°ä¸»è¦ä¾èµ–äº’æ–¥é”ï¼ˆmutex &amp;amp; unique_lockï¼‰å®ç°ï¼Œçº¿ç¨‹åœ¨è¿›è¡Œæ¯é¡¹æ“ä½œæ—¶éœ€è¦å…ˆAcquireé”çš„æ‰€æœ‰æƒï¼Œåœ¨æ‰§è¡Œå®Œæ“ä½œåéœ€è¦Releaseé”çš„æ‰€æœ‰æƒã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä¸å¯¹ä¿®æ”¹æ“ä½œçš„åˆæ³•æ€§è¿›è¡Œæ£€æŸ¥ï¼Œè€Œæ˜¯é€‰æ‹©ç›´æ¥å¯¹ä¸åˆæ³•çš„è¶Šç•Œæ“ä½œæŠ›å‡ºå¼‚å¸¸ã€‚æœ‰é”æ ˆçš„å®ç°ç®€å•ï¼Œç¬¦åˆä¸€èˆ¬çš„å¤šçº¿ç¨‹ç¼–ç¨‹é€»è¾‘æ¯”è¾ƒç›´è§‚ã€‚åœ¨è¿™é‡Œä½¿ç”¨æ ‡å‡†åº“è‡ªå¸¦çš„RAIIé”ï¼Œç¼–ç¨‹å®ç°éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ä¸ºæ— é”æ ˆå®ç°çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;atomic&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;new_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;new_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_relaxed&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compare_exchange_weak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_node&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_release&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_relaxed&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="nf"&gt;top&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_acquire&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;runtime_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Stack is empty.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_relaxed&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;Node&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;*&lt;/span&gt; &lt;span class="n"&gt;next_node&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compare_exchange_weak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;next_node&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_release&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_relaxed&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;top_node&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;runtime_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#34;Stack is empty.&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;is_empty&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;noexcept&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memory_order_acquire&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="k"&gt;nullptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯¹æ¯”æœ‰é”æ ˆï¼Œæ— é”æ ˆåœ¨å®ç°ä¸Šå›°éš¾äº†ä¸å°‘ï¼Œè¿™ä¸»è¦ç‰µæ¶‰åˆ°å¯¹CASçš„ç†è§£ä¸Šã€‚è¿™ä¸€éƒ¨åˆ†çš„ç†è®ºéƒ¨åˆ†åœ¨å‰æ–‡ä¸å‚è€ƒèµ„æ–™ä¸­æœ‰æ¯”è¾ƒè¯¦ç»†çš„æè¿°ï¼Œè¿™é‡Œå†ç®€å•å¯¹C++ä»£ç å®ç°æ–¹é¢åšä¸€ä¸ªè§£é‡Šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;headä½œä¸ºæ ˆé¡¶å…ƒç´ çš„æŒ‡é’ˆï¼Œåœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯åŸå­å˜é‡ç±»å‹ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨ä¸€ä¸ªCPU Instructionä¸­å®Œæˆå¯¹å˜é‡çš„æ“ä½œï¼Œä»è€Œé¿å…ä¸­é—´çŠ¶æ€çš„äº§ç”Ÿï¼Œä¹Ÿå°±ä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€‚åŸå­æ“ä½œå­˜åœ¨å†…å­˜åºçš„æ¦‚å¿µï¼Œåœ¨è¿™é‡Œç”¨åˆ°äº†ä¸‰ç§å†…å­˜åºï¼Œåˆ†åˆ«è§£é‡Šå¦‚ä¸‹
&lt;ul&gt;
&lt;li&gt;memory_order_relaxed: æ¾æ•£å†…å­˜é¡ºåºã€‚è¿™ä¸ªæ¨¡å¼ä¿è¯äº†è¯»æ“ä½œä¸ä¼šè¢«é‡æ’ï¼Œä½†å¯¹äºå†™æ“ä½œæ²¡æœ‰ä»»ä½•ä¿è¯ã€‚&lt;/li&gt;
&lt;li&gt;memory_order_releaseï¼šé‡Šæ”¾å†…å­˜é¡ºåºã€‚ä¿éšœäº†è¯»å†™é¡ºåºï¼Œé€šå¸¸ä¸é€‚ç”¨äºload()ã€‚&lt;/li&gt;
&lt;li&gt;memory_order_acquireï¼šè·å–å†…å­˜é¡ºåºã€‚ä¿éšœäº†è¯»å†™é¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;atomic.load()&lt;/code&gt;çš„ä½œç”¨æ˜¯å®‰å…¨åœ°è¯»å–ä¸€ä¸ªåŸå­å˜é‡ï¼Œå…¶ä¸­å‚æ•°ä¸ºå†…å­˜åºï¼ˆMemory Orderï¼‰ã€‚åœ¨Pushå’ŒPopæ“ä½œä¸­é€‰æ‹©çš„loadçš„å†…å­˜åºä¸ºmemory_order_relaxedï¼Œè¿™æ˜¯å› ä¸ºè¿™é‡Œè€ƒè™‘CASæ–¹å¼ä¹±åºåœ°æ’å…¥ä¸åˆ é™¤å…ƒç´ ï¼Œå³å…ƒç´ æœ¬èº«çš„é¡ºåºå¹¶ä¸é‡è¦ï¼›è€Œåœ¨IsEmptyæ“ä½œä¸­çš„å†…å­˜åºä¸ºmemory_order_acquireï¼Œè¿™ä¸»è¦æ˜¯è€ƒè™‘åœ¨å½“å‰æ—¶é—´ç‚¹æ‰§è¡ŒIsEmptyçš„ç»“æœçš„æ­£ç¡®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;atomic.compare_exchange_weak()&lt;/code&gt;ç”¨äºæ‰§è¡ŒåŸå­æ¯”è¾ƒå’Œäº¤æ¢æ“ä½œï¼Œä¹Ÿå°±æ˜¯CASæœºåˆ¶çš„ä¸»è¦å®ç°ã€‚å…¶ä¸­ä¸€ä¸ªå‚æ•°ä¸ºExpectedï¼Œæ˜¯Compareè¿‡ç¨‹æ¯”è¾ƒçš„å€¼ï¼›ç¬¬äºŒä¸ªå˜é‡ä¸ºDesireï¼Œæ˜¯Swapè¿‡ç¨‹æƒ³è¦äº¤æ¢ä¸ºçš„å€¼ã€‚å…¶å·¥ä½œè¿‡ç¨‹ä¸ºï¼Œæ¯”è¾ƒatomicå˜é‡ä¸Expectedæ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™äº¤æ¢ä¸ºDesireï¼Œå¦åˆ™é€€åŒ–ä¸ºä¸€ä¸ªloadçš„è¿‡ç¨‹ï¼Œå°†æœ€æ–°çš„atomicçš„å€¼åŠ è½½è¿›Desireã€‚åä¸¤ä¸ªå‚æ•°åˆ™ä¸ºæ¯”è¾ƒsuccessæˆ–failureåçš„å†…å­˜åºã€‚å€¼å¾—ä¸€æçš„æ˜¯&lt;code&gt;atomic.compare_exchange_strong()&lt;/code&gt;ä¹Ÿå€¼å¾—äº†è§£ï¼Œå…¶ä¸»è¦é€‚ç”¨äºä¸éœ€è¦å¾ªç¯é‡è¯•çš„åœºæ™¯ï¼Œå…³æ³¨å¯é æ€§çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;è¿™ä¸€éƒ¨åˆ†çš„å†…å®¹æœ‰ä¸€äº›éš¾ç†è§£ï¼Œå¦‚æœè¯»åˆ°è¿™é‡Œä½ æœ‰æ‰€å›°æƒ‘ï¼Œå»ºè®®å»æŸ¥æ‰¾æ›´å¤šå…³äºCASæœºåˆ¶åŠC++å†…å­˜åºçš„ç›¸å…³èµ„æ–™ï¼Œæœ¬æ–‡ä¸å†è¯¦ç»†å±•å¼€&lt;del&gt;ï¼ˆæ²¡é”™æˆ‘ä¹Ÿè®²ä¸æ˜ç™½ğŸ˜”ï¼‰&lt;/del&gt;ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è¿›è¡Œå…¬å¹³å¯¹æ¯”ï¼Œåœ¨è¿™é‡Œå®šä¹‰å®éªŒä»»åŠ¡ä¸ºï¼šåœ¨æ¯ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ&lt;code&gt;1,000,000&lt;/code&gt;æ¬¡å…¥æ ˆæ“ä½œï¼Œå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;ok&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;enqueue&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ä½¿ç”¨çº¿ç¨‹æ± åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œä»ä»»åŠ¡åˆ›å»ºå¼€å§‹è®¡æ—¶ï¼Œä»¥ä¸¤ä¸ªçº¿ç¨‹çš„å…¥æ ˆä»»åŠ¡ç»“æŸæˆªæ­¢è®¡æ—¶ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;chrono&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;high_resolution_clock&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// Assign tasks to thread pool.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ok_1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ok_2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;stop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;chrono&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;high_resolution_clock&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;duration&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;chrono&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;duration_cast&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;chrono&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;microseconds&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;duration&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æœ¬æ–‡æ‰€æåˆ°çš„çº¿ç¨‹æ± ã€æœ‰é”æ ˆå’Œæ— é”æ ˆçš„å®Œæ•´ä»£ç å®ç°å‡å¯åœ¨æœ¬äººçš„å¼€æºé¡¹ç›®&lt;a class="link" href="https://github.com/Kuludu/MyDSA/" target="_blank" rel="noopener"
&gt;MyDSA&lt;/a&gt;ä¸­æ‰¾åˆ°ï¼ˆå¦‚æœå¯¹ä½ æœ‰ç”¨ï¼Œä¹Ÿéº»çƒ¦ç‚¹ä¸€ä¸ªå°æ˜Ÿæ˜Ÿå‘€ï¼ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="å®éªŒç»“æœ"&gt;å®éªŒç»“æœ
&lt;/h3&gt;&lt;p&gt;å®éªŒç»“æœå¦‚ä¸‹è¡¨ï¼ˆå•ä½ä¸ºmicrosecondï¼‰ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;æœ‰é”æ ˆ&lt;/th&gt;
&lt;th&gt;æ— é”æ ˆ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;#1&lt;/td&gt;
&lt;td&gt;1,003,863&lt;/td&gt;
&lt;td&gt;399,217&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;#2&lt;/td&gt;
&lt;td&gt;884,579&lt;/td&gt;
&lt;td&gt;186,314&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;#3&lt;/td&gt;
&lt;td&gt;1,013,956&lt;/td&gt;
&lt;td&gt;427,235&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Avg&lt;/td&gt;
&lt;td&gt;967,466&lt;/td&gt;
&lt;td&gt;337,588&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä»å®éªŒç»“æœçš„å¹³å‡å€¼æ¥çœ‹ï¼Œæœ‰é”æ ˆç›¸è¾ƒäºæ— é”æ ˆå¿«äº†2.86å€ã€‚å½“ç„¶è¿™åªæ˜¯ä»å…¥æ ˆæ•ˆç‡ä¸Šæ¥è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå¦‚æœåŠ ä¸Šéšæœºå‡ºæ ˆä¸å–å€¼æ“ä½œå¯èƒ½ä¼šæœ‰å·®å¼‚ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="reference"&gt;Reference
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://tech.meituan.com/2024/07/19/multi-threading-and-multi-thread-synchronization.html" target="_blank" rel="noopener"
&gt;åŸºæœ¬åŠŸ | ä¸€æ–‡è®²æ¸…å¤šçº¿ç¨‹å’Œå¤šçº¿ç¨‹åŒæ­¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://blog.csdn.net/davidhopper/article/details/131430830" target="_blank" rel="noopener"
&gt;C++æ— é”ç¼–ç¨‹â€”â€”æ— é”æ ˆ(lock-free stack)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.cnblogs.com/ljmiao/p/18145946" target="_blank" rel="noopener"
&gt;C++å…­ç§å†…å­˜åºè¯¦è§£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>è”é‚¦å­¦ä¹ ä¸­çš„non-IIDæ•°æ®</title><link>https://blog.kuludu.net/article/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84non-iid%E6%95%B0%E6%8D%AE/</link><pubDate>Fri, 23 Sep 2022 14:07:00 +0800</pubDate><guid>https://blog.kuludu.net/article/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84non-iid%E6%95%B0%E6%8D%AE/</guid><description>&lt;h2 id="å…³äºnon-iidæ•°æ®"&gt;å…³äºnon-IIDæ•°æ®
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;independent and identically distributed(IID)&lt;strong&gt;å³&lt;/strong&gt;ç‹¬ç«‹åŒåˆ†å¸ƒ&lt;/strong&gt;ï¼ŒæŒ‡çš„æ˜¯å…¨ä½“æ ·æœ¬æœä»æŸä¸€åˆ†å¸ƒï¼Œè€Œæ¯æ¬¡è·å¾—çš„æ ·æœ¬éƒ½æ˜¯ç‹¬ç«‹åœ°ä»è¿™ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·è·å¾—çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ç‹¬ç«‹&lt;/code&gt;ï¼šæŒ‡çš„æ˜¯æ¯æ¬¡é‡‡æ ·ä¹‹é—´ä¸ä¼šæœ‰å…³ç³»ã€‚ä¾‹å¦‚å¤šæ¬¡æŠ•éª°å­ï¼Œç¬¬ä¸€æ¬¡æŠ•å’Œç¬¬åæ¬¡æŠ•ä¹‹é—´æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼›ç›¸è¾ƒä¹‹ä¸‹ï¼Œå‡ºç°ä¹Œäº‘ä¸ä¸‹é›¨å°±éç‹¬ç«‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;åŒåˆ†å¸ƒ&lt;/code&gt;ï¼šæŒ‡çš„æ˜¯éšæœºå˜é‡æœä»ç»Ÿä¸€åˆ†å¸ƒã€‚ä»ä»¥éª°å­ä¸¾ä¾‹ï¼Œè‹¥éª°å­è´¨é‡åˆ†å¸ƒä¸ä¼šå˜åŠ¨ï¼Œåˆ™æ¯æ¬¡æŠ•çš„ç»“æœå°†ä¼šå‘ˆç°ä¸€å®šçš„è§„å¾‹ï¼›ç›¸è¾ƒä¹‹ä¸‹è‹¥é‡‡ç”¨ä½œå¼Šéª°å­ï¼ˆå¯ä»¥äººä¸ºæ”¹å˜æŸä¸€ç«¯çš„è´¨é‡ï¼‰ï¼Œåˆ™ä¼šç ´åè¿™ä¸€æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;non-IID&lt;/strong&gt;è‡ªç„¶æ˜¯ä»¥ä¸Šæ¦‚å¿µçš„å¦å‘½é¢˜ï¼ˆç‹¬ç«‹å’ŒåŒåˆ†å¸ƒä»»æ„ä¸æ»¡è¶³å³å¯ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="è”é‚¦å­¦ä¹ ä¸­çš„non-iidæ•°æ®åˆ†ç±»"&gt;è”é‚¦å­¦ä¹ ä¸­çš„non-IIDæ•°æ®åˆ†ç±»
&lt;/h2&gt;&lt;p&gt;åœ¨çœŸå®ä¸–ç•Œä¸­æ•°æ®å¾€å¾€ä¼šå› ä¸ºå„ç§å„æ ·çš„åŸå› è€Œå‘ˆç°non-IIDçš„ç‰¹æ€§ï¼ˆä¾‹å¦‚æŸåœ°é›¨æ°´å¤©æ°”å¤šï¼Œç”Ÿé”ˆæ•…éšœçš„æ ·æœ¬ä¼šæ›´å¤šï¼‰ã€‚åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæˆ‘ä»¬ä¸å¦¨ä»è¾“å…¥ç©ºé—´$X$ä¸è¾“å‡ºç©ºé—´$Y$æ¥è€ƒè™‘ã€‚&lt;/p&gt;
&lt;h3 id="å‡è®¾æ ·æœ¬ç‹¬ç«‹ä½†ä¸åŒåˆ†å¸ƒ"&gt;å‡è®¾æ ·æœ¬ç‹¬ç«‹ä½†ä¸åŒåˆ†å¸ƒ
&lt;/h3&gt;&lt;p&gt;æ ·æœ¬æ»¡è¶³è´å¶æ–¯å…¬å¼ï¼š$P(X,Y)=P(X)P(Y|X)$ã€‚å¯¹äºå®¢æˆ·ç«¯$i$ä¸$j$ï¼Œè€ƒè™‘$P_i(X)$ï¼ˆ$i$è¾“å…¥åˆ†å¸ƒï¼‰ã€$P_i(Y|X)$ï¼ˆ$i$æ ‡ç­¾åˆ†å¸ƒï¼‰ä¸$P_j(X)$ï¼ˆ$j$è¾“å…¥åˆ†å¸ƒï¼‰ã€$P_j(Y|X)$ï¼ˆ$j$è¾“å…¥åˆ†å¸ƒï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‹¥$P_i(X)\ne P_j(X)$ï¼Œä¸”$P_i(Y|X)=P_j(Y|X)$ï¼šå®¢æˆ·ç«¯è¾“å…¥ä¸ç›¸åŒï¼Œä½†è¾“å‡ºç›¸åŒã€‚ä¾‹å¦‚ä¸åŒå›½å®¶å¯¹äºæ±½è½¦è¡Œé©¶æ–¹å‘çš„è§„å®šä¸åŒï¼Œä½†éƒ½éœ€è¦éµå®ˆç›¸åŒçš„äº¤é€šè§„åˆ™ï¼ˆè·Ÿéšä¿¡å·ç¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥$P_i(X)= P_j(X)$ï¼Œä¸”$P_i(Y|X)\ne P_j(Y|X)$ï¼šå®¢æˆ·ç«¯è¾“å…¥ç›¸åŒï¼Œä½†è¾“å‡ºä¸ç›¸åŒã€‚ä¾‹å¦‚ä¸åŒåœ°åŒºå¯¹äºäº¤é€šæ³•è§„çš„å®šä¹‰ä¸åŒï¼Œæœ‰äº›åœ°åŒºçº¢ç¯å¿…é¡»åœæ­¢ï¼Œè€Œæœ‰äº›åœ°åŒºå¯ä»¥åœ¨ç¡®è®¤å®‰å…¨çš„æƒ…å†µä¸‹é€šè¡Œã€‚&lt;/li&gt;
&lt;li&gt;è‹¥$P_i(X)\ne P_j(X)$ï¼Œä¸”$P_i(Y|X)\ne P_j(Y|X)$ï¼šå®¢æˆ·ç«¯è¾“å…¥è¾“å‡ºå‡ä¸ç›¸åŒã€‚æ­¤ä¸ºä»¥ä¸Šä¸¤ç§æƒ…å†µçš„ç»„åˆï¼Œä¾‹å¦‚è¡Œé©¶æ–¹å‘ä¸äº¤é€šæ³•è§„å‡ä¸ç›¸åŒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è‹¥$P_i(X)=P_j(X)$ï¼Œä¸”$P_i(Y|X)=P_j(Y|X)$ï¼šä¸å‡è®¾ä¸ç¬¦ï¼ˆè¿™æ˜¯IIDï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="å‡è®¾æ ·æœ¬ä¸ç‹¬ç«‹ä½†åŒåˆ†å¸ƒ"&gt;å‡è®¾æ ·æœ¬ä¸ç‹¬ç«‹ä½†åŒåˆ†å¸ƒ
&lt;/h3&gt;&lt;p&gt;å¯¹äºå…¨ä½“æ ·æœ¬è€Œè¨€è€ƒè™‘$X\sim B(n,p)$ï¼Œé‚£ä¹ˆè‹¥æœ‰$Y=(n-X)\sim B(n,p)$åˆ™è¾“å…¥ä¸è¾“å‡ºä¸ç‹¬ç«‹ä½†åŒåˆ†å¸ƒã€‚ä¾‹å¦‚æŠ›$n$æ¬¡ç¡¬å¸$x$æ¬¡æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸$n-x$æ¬¡åé¢æœä¸Šçš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;p&gt;æ”¾åœ¨è”é‚¦å­¦ä¹ çš„è§’åº¦ï¼Œå¯ä»¥ç†è§£ä¸º$P_i(X)$ä¸$P_j(X)$ä¸ç‹¬ç«‹ï¼Œè€Œ$P_i(Y|X)=P_j(Y|X)$æœä»åŒä¸€åˆ†å¸ƒã€‚ä¾‹å¦‚é“¶è¡Œä¸­ç”¨æˆ·æ•°æ®å¼‚æ„ä½†ç”¨æˆ·å¤§å¤šä¸€æ ·ã€‚&lt;/p&gt;
&lt;h3 id="å‡è®¾æ ·æœ¬ä¸ç‹¬ç«‹ä¸”ä¸åŒåˆ†å¸ƒ"&gt;å‡è®¾æ ·æœ¬ä¸ç‹¬ç«‹ä¸”ä¸åŒåˆ†å¸ƒ
&lt;/h3&gt;&lt;p&gt;æ¯”å¦‚è¯»paperä¸æ‰å¤´å‘çš„å…³ç³»ï¼ˆï¼Ÿ&lt;/p&gt;
&lt;h2 id="å†ä»æ ·æœ¬ç‰¹æ€§ä¸Šåˆ†ç±»"&gt;å†ä»æ ·æœ¬ç‰¹æ€§ä¸Šåˆ†ç±»
&lt;/h2&gt;&lt;h3 id="å±æ€§å€¾æ–œ"&gt;å±æ€§å€¾æ–œ
&lt;/h3&gt;&lt;p&gt;å±æ€§å€¾æ–œä»å®¢æˆ·ç«¯æ ·æœ¬å±æ€§é‡å ç¨‹åº¦å‡ºå‘è€ƒè™‘ï¼Œåˆ†ä¸ºï¼šéé‡å å±æ€§å€¾æ–œï¼ˆNon-overlapping Attribute Skewï¼‰ã€éƒ¨åˆ†é‡å å±æ€§å€¾æ–œï¼ˆPartial Overlapping Attribute Skewï¼‰ä¸å®Œå…¨é‡å å±æ€§å€¾æ–œï¼ˆFull Overlapping Attribute Skewï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="éé‡å å±æ€§å€¾æ–œ"&gt;éé‡å å±æ€§å€¾æ–œ
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯çš„å±æ€§å®Œå…¨æ²¡æœ‰é‡å ï¼ˆä¾‹å¦‚$k_1$æ‹¥æœ‰å±æ€§$A,B$ï¼Œ$k_2$æ‹¥æœ‰å±æ€§$C,D$ï¼‰ï¼Œä½†å±•ç°å¼ºç›¸å…³æ€§ï¼Œæ­¤æ—¶å¯ä»¥è§†ä¸ºçºµå‘è”é‚¦å­¦ä¹ ï¼ˆVertical FLï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="éƒ¨åˆ†é‡å å±æ€§å€¾æ–œ"&gt;éƒ¨åˆ†é‡å å±æ€§å€¾æ–œ
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯çš„å±æ€§éƒ¨åˆ†é‡å ï¼ˆä¾‹å¦‚$k_1$æ‹¥æœ‰å±æ€§$A,B$ï¼Œ$k_2$æ‹¥æœ‰å±æ€§$B,D$ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id="å®Œå…¨é‡å å±æ€§å€¾æ–œ"&gt;å®Œå…¨é‡å å±æ€§å€¾æ–œ
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯çš„å±æ€§éƒ¨åˆ†é‡å ï¼ˆä¾‹å¦‚$k_1$æ‹¥æœ‰å±æ€§$A,B$ï¼Œ$k_2$ä¹Ÿæ‹¥æœ‰å±æ€§$A,B$ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="æ ‡ç­¾å€¾æ–œ"&gt;æ ‡ç­¾å€¾æ–œ
&lt;/h3&gt;&lt;h4 id="æ ‡ç­¾åˆ†å¸ƒå€¾æ–œ"&gt;æ ‡ç­¾åˆ†å¸ƒå€¾æ–œ
&lt;/h4&gt;&lt;h4 id="æ ‡ç­¾åå¥½å€¾æ–œ"&gt;æ ‡ç­¾åå¥½å€¾æ–œ
&lt;/h4&gt;&lt;p&gt;å®¢æˆ·ç«¯å¯¹æ ·æœ¬çš„åå¥½ä¸åŒï¼ˆå¯¹äºåŒä¸€æ ·æœ¬ï¼Œå®¢æˆ·ç«¯$A$å–œæ¬¢ï¼Œ$B$ä¸å–œæ¬¢ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="æ—¶é—´å€¾æ–œ"&gt;æ—¶é—´å€¾æ–œ
&lt;/h3&gt;&lt;p&gt;éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå®¢æˆ·ç«¯çš„æ•°æ®ä¼šæœ‰æ‰€å€¾æ–œï¼ˆå¯å‚è€ƒè”é‚¦å¢é‡å­¦ä¹ ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id="å…¶å®ƒ"&gt;å…¶å®ƒ
&lt;/h3&gt;&lt;h4 id="å±æ€§æ ‡ç­¾å€¾æ–œ"&gt;å±æ€§&amp;amp;æ ‡ç­¾å€¾æ–œ
&lt;/h4&gt;&lt;h4 id="è´¨é‡å€¾æ–œ"&gt;è´¨é‡å€¾æ–œ
&lt;/h4&gt;&lt;hr&gt;
&lt;h2 id="ref"&gt;Ref
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Non-IID data and Continual Learning processes in Federated Learning: A long road ahead&lt;/li&gt;
&lt;li&gt;Federated Learning on Non-IID Data: A Survey&lt;/li&gt;
&lt;li&gt;Federated Visual Classification with Real-World Data Distribution&lt;/li&gt;
&lt;li&gt;ã€Šæœºå™¨å­¦ä¹ ã€‹ - å‘¨å¿—åè‘—&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>lower_bound()çš„ä¸€ä¸ªæœªé¢„æœŸçš„æ‰§è¡Œè¡Œä¸º</title><link>https://blog.kuludu.net/article/lower_bound%E7%9A%84%E4%B8%80%E4%B8%AA%E6%9C%AA%E9%A2%84%E6%9C%9F%E7%9A%84%E6%89%A7%E8%A1%8C%E8%A1%8C%E4%B8%BA/</link><pubDate>Tue, 15 Jun 2021 15:36:00 +0800</pubDate><guid>https://blog.kuludu.net/article/lower_bound%E7%9A%84%E4%B8%80%E4%B8%AA%E6%9C%AA%E9%A2%84%E6%9C%9F%E7%9A%84%E6%89%A7%E8%A1%8C%E8%A1%8C%E4%B8%BA/</guid><description>&lt;p&gt;å‰ä¸€é˜µï¼Œåè¾ˆé—®äº†æˆ‘ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;&lt;/span&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;greater&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸ºä»€ä¹ˆè¿™æ®µä»£ç ä¸ºä»€ä¹ˆæ‰§è¡Œç»“æœä¸º0ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¡®å®ï¼Œä»ç›´è§‚æ€è€ƒä¸Šæ¥è¯´ï¼Œè¿”å›ç»“æœç¡®å®æœ‰äº›è¯¡å¼‚ã€‚ä¸€æ—¶é—´æˆ‘ä¹Ÿä¸å¤ªç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯æ¯”è¾ƒ &lt;code&gt;p&lt;/code&gt;ä¸ &lt;code&gt;a.end()&lt;/code&gt;çš„ä½ç½®å…³ç³»ï¼Œå‘ç° &lt;code&gt;p=a.end()&lt;/code&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;strong&gt;å‡½æ•°å¹¶æ²¡æœ‰åœ¨å®¹å™¨ä¸­æ‰¾åˆ°æ¯”aå¤§çš„å…ƒç´ &lt;/strong&gt;ï¼Œè¿™å¹¶ä¸ç¬¦åˆé¢„æœŸçš„æ‰§è¡Œç»“æœã€‚&lt;/p&gt;
&lt;p&gt;é‡äº‹ä¸å†³ç¿»æ–‡æ¡£ï¼Œäºæ˜¯æˆ‘æ‰¾åˆ°äº†&lt;a class="link" href="https://zh.cppreference.com/w/cpp/algorithm/upper_bound" target="_blank" rel="noopener"
&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚å…¶ä¸­è¯¦ç»†ä»‹ç»äº† &lt;code&gt;upper_bound&lt;/code&gt;å‡½æ•°çš„åŸå‹ä¸å®šä¹‰ï¼Œå…¶ä¸­ä»‹ç»ä¸­çš„è¿™å¥è¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;èŒƒå›´ &lt;code&gt;[first, last)&lt;/code&gt; å¿…é¡»å·²ç›¸å¯¹äºè¡¨è¾¾å¼ !(value &amp;lt; element) æˆ– !comp(value, element) åˆ’åˆ†ï¼Œå³æ‰€æœ‰ä»¤æ­¤è¡¨è¾¾å¼ä¸º true çš„å…ƒç´ å¿…é¡»å‰è¶‹æ‰€æœ‰ä»¤æ­¤è¡¨è¾¾å¼ä¸º false çš„å…ƒç´ ã€‚å®Œå…¨æ’åºçš„èŒƒå›´æ»¡è¶³æ­¤åˆ¤åˆ«æ ‡å‡†ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;é™¤äº†å¸¸æåˆ°çš„åºåˆ—æœ‰åºå‰æä»¥å¤–ï¼Œ&lt;code&gt;lower_bound&lt;/code&gt;å¯¹é‡è½½çš„æ¯”è¾ƒå…³ç³»ä¹Ÿæœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†ä¸Šä¾‹ä¸­ &lt;code&gt;lower_bound&lt;/code&gt;å‡½æ•°ä¸ç¬¦åˆé¢„æœŸçš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒå…¶ç»™å‡ºäº†å‡½æ•°å¯èƒ½çš„å®ç°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ForwardIt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Compare&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;ForwardIt&lt;/span&gt; &lt;span class="n"&gt;upper_bound&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ForwardIt&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ForwardIt&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Compare&lt;/span&gt; &lt;span class="n"&gt;comp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;ForwardIt&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;iterator_traits&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ForwardIt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;::&lt;/span&gt;&lt;span class="n"&gt;difference_type&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¹Ÿå¯¹åº”äº†ä»‹ç»ä¸­çš„è¯´æ³•ï¼Œå½“é‡‡ç”¨ä¸Šä¾‹çš„å‡½æ•°æ¨¡ç‰ˆé‡è½½å¤§å°å…³ç³»ï¼Œä¼šä½¿è¿­ä»£å™¨ &lt;code&gt;it&lt;/code&gt;ä¸æ–­å‘åè¿­ä»£ï¼Œç›´è‡³ä¸ &lt;code&gt;a.end()&lt;/code&gt;é‡åˆã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¦ä½¿è¿è¡Œç»“æœæ­£ç¡®ï¼Œå¯ä»¥å¯¹å‡½æ•°ä¼ é€’ &lt;code&gt;a&lt;/code&gt;çš„åå‘è¿­ä»£å™¨ &lt;code&gt;a.rbegin()&lt;/code&gt;ä¸ &lt;code&gt;a.rend()&lt;/code&gt;ã€‚å³ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-cpp" data-lang="cpp"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;&lt;/span&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rbegin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rend&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;greater&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ–è€…ä½¿ç”¨ &lt;code&gt;reverse&lt;/code&gt;å‡½æ•°å…ˆå¯¹åºåˆ—è¿›è¡Œåè½¬ï¼Œå½“ç„¶ï¼Œè¿™æ ·ä¼šé€ æˆæ€§èƒ½æŸå¤±ã€‚&lt;/p&gt;</description></item></channel></rss>